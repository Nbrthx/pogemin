<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hello Database</title>
</head>
<body>
  <form action="/do" method="post">
    <h1>Query Zone</h1>
    <a href="/disconnect">Disconn</a>
    <textarea style="resize: none; width: 100%; height: 500px;" name="query"><%= que %></textarea><br>
    <input type="submit" value="Submit"><br>
  </form>
  <br>
  <input type="button" value="Toggle Mode" onclick="switch_mode()"> <br>
  <b>output:</b> <br>
  <div id="console">
    <textarea style="resize: none; width: 100%; height: 500px;" readonly>
      <%= rlog %>
    </textarea>
  </div>
  <div id="table"></div>
  <br>
  <script type="text/javascript">
    var mode = "console";

    var table = document.getElementById("table");
    table.style.display = "none";
    
    var rlog = <%= rlog %>;

    function switch_mode() {
      var show = document.getElementById(mode);
      show.style.display = "none";

      if(mode == "console") mode = "table";
      else mode = "console";
      
      show = document.getElementById(mode);
      show.style.display = "block";
    }

    function tables(){
      var data = JSON.parse(rlog);
      
      table.innerHTML += "<table>";
      if(data.command == "SELECT"){
        table.innerHTML += "<tr>";
        for(var th in data.rows[0]){
          table.innerHTML += "<th>"+th+"</th>";
        }
        table.innerHTML += "</tr>";
        for(var row in data.rows){
          table.innerHTML += "<tr>";
          for(var td in row){
            table.innerHTML += "<td>"+row[td]+"</td>";
          }
          table.innerHTML += "</tr>";
        }
      }
      table.innerHTML += "</table>";
    }
    if(rlog != null && rlog != "") tables();
  </script>
</body>
</html>
